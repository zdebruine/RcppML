<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="VSE">
<title>Vectorized Sparse Encoding • VSE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Vectorized Sparse Encoding">
<meta property="og:description" content="VSE">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">VSE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.99</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/introduction.html">Vectorized Sparse Encoding</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Vectorized Sparse Encoding</h1>
            
      
      
      <div class="d-none name"><code>introduction.Rmd</code></div>
    </div>

    
    
<p>Vectorized Sparse Encodings (VSE) efficiently compress sparse data in
single-vector strucutres. VSEs are column vectors with sparse random
access iterators that instruct a generic sparse matrix wrapper class how
to interpret the sparse encoding. A sparse matrix is simply a of VSEs
for each column.</p>
<p>A VSE is a column vector, and can be ordered into a matrix-alike
format using . In such a configuration, VSE sparse matrices can hold up
to 2^32 non-zero elements in each column.</p>
<div class="section level2">
<h2 id="types-of-vectorized-sparse-encodings">Types of Vectorized Sparse Encodings<a class="anchor" aria-label="anchor" href="#types-of-vectorized-sparse-encodings"></a>
</h2>
<p>There are several types of VSEs, categorized as follows:</p>
<ul>
<li>
<code>CSC</code>: Colum Sparse Compressed is the base structure, and
records non-zero value/index information in some form or another.</li>
<li>
<code>P</code>: type polymorphic, meaning indices and values can be
different types.</li>
<li>
<code>NP</code>: type non-polymorphic, meaning indices and values
must be of the same type (usually integral)</li>
<li>
<code>T</code>: Tabulated, meaning each unique value is only given
once, and precedes indices at which that value occurs.</li>
<li>
<code>R</code>: Run, in tabulated storage, where a value is
immediately followed by the run size (number of indices with that value)
followed by the indices at which that value occurs.</li>
</ul>
<p>The following VSEs are implemented in this package: <code>CSC</code>
(not vectorized), <code>CSC_P</code>, <code>CSC_NP</code>,
<code>TCSC_P</code>, <code>TCSC_NP</code>, and
<code>TRCSC_NP</code>.</p>
</div>
<div class="section level2">
<h2 id="internal-structure-of-vses">Internal Structure of VSEs<a class="anchor" aria-label="anchor" href="#internal-structure-of-vses"></a>
</h2>
<p>VSEs are coded in C++ from <code>std::vector</code> and
<code>std::pair</code> using two template types, a value type
(<code>val_t</code>) and an index type <code>(idx_t</code>).</p>
<p>Here we simulate a small random matrix to inspect. The C++ structure
is not easily appreciated in R debug, but the <code><a href="../reference/inspect.html">VSE::inspect</a></code>
function allows us to gain some idea of what the encoding looks like
using R lists.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">VSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Matrix.R-forge.R-project.org/" class="external-link">Matrix</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/rsparsematrix.html" class="external-link">rsparsematrix</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">2</span>, density <span class="op">=</span> <span class="fl">0.25</span>, rand.x <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span></span>
<span><span class="co">#&gt; 30 x 2 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">#&gt;          </span></span>
<span><span class="co">#&gt;  [1,] . 1</span></span>
<span><span class="co">#&gt;  [2,] . .</span></span>
<span><span class="co">#&gt;  [3,] 3 .</span></span>
<span><span class="co">#&gt;  [4,] . .</span></span>
<span><span class="co">#&gt;  [5,] 3 .</span></span>
<span><span class="co">#&gt;  [6,] . .</span></span>
<span><span class="co">#&gt;  [7,] . 1</span></span>
<span><span class="co">#&gt;  [8,] . .</span></span>
<span><span class="co">#&gt;  [9,] . .</span></span>
<span><span class="co">#&gt; [10,] . .</span></span>
<span><span class="co">#&gt; [11,] . .</span></span>
<span><span class="co">#&gt; [12,] . 2</span></span>
<span><span class="co">#&gt; [13,] . 2</span></span>
<span><span class="co">#&gt; [14,] 1 .</span></span>
<span><span class="co">#&gt; [15,] 1 .</span></span>
<span><span class="co">#&gt; [16,] . .</span></span>
<span><span class="co">#&gt; [17,] . .</span></span>
<span><span class="co">#&gt; [18,] . 3</span></span>
<span><span class="co">#&gt; [19,] . .</span></span>
<span><span class="co">#&gt; [20,] . 3</span></span>
<span><span class="co">#&gt; [21,] . 1</span></span>
<span><span class="co">#&gt; [22,] . .</span></span>
<span><span class="co">#&gt; [23,] . .</span></span>
<span><span class="co">#&gt; [24,] . .</span></span>
<span><span class="co">#&gt; [25,] 3 .</span></span>
<span><span class="co">#&gt; [26,] 2 .</span></span>
<span><span class="co">#&gt; [27,] 1 2</span></span>
<span><span class="co">#&gt; [28,] . .</span></span>
<span><span class="co">#&gt; [29,] . .</span></span>
<span><span class="co">#&gt; [30,] . .</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="co">#&gt; Formal class 'dgCMatrix' [package "Matrix"] with 6 slots</span></span>
<span><span class="co">#&gt;   ..@ i       : int [1:15] 2 4 13 14 24 25 26 0 6 11 ...</span></span>
<span><span class="co">#&gt;   ..@ p       : int [1:3] 0 7 15</span></span>
<span><span class="co">#&gt;   ..@ Dim     : int [1:2] 30 2</span></span>
<span><span class="co">#&gt;   ..@ Dimnames:List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : NULL</span></span>
<span><span class="co">#&gt;   .. ..$ : NULL</span></span>
<span><span class="co">#&gt;   ..@ x       : num [1:15] 3 3 1 1 3 2 1 1 1 2 ...</span></span>
<span><span class="co">#&gt;   ..@ factors : list()</span></span></code></pre></div>
<div class="section level3">
<h3 id="csc">CSC<a class="anchor" aria-label="anchor" href="#csc"></a>
</h3>
<p>Stored as <code>std::vector&lt;idx_t&gt; i</code> and
<code>std::vector&lt;idx_t&gt; x</code>. Two vectors, thus not fully
vectorized, requiring joint traversal during any iteration.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">A</span>, <span class="st">"CSC"</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ :List of 2</span></span>
<span><span class="co">#&gt;   ..$ i: num [1:7] 2 4 13 14 24 25 26</span></span>
<span><span class="co">#&gt;   ..$ x: int [1:7] 3 3 1 1 3 2 1</span></span>
<span><span class="co">#&gt;  $ :List of 2</span></span>
<span><span class="co">#&gt;   ..$ i: num [1:8] 0 6 11 12 17 19 20 26</span></span>
<span><span class="co">#&gt;   ..$ x: int [1:8] 1 1 2 2 3 3 1 2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="csc_p">CSC_P<a class="anchor" aria-label="anchor" href="#csc_p"></a>
</h3>
<p>Stored as
<code>std::vector&lt;std::pair&lt;idx_t, val_t&gt;&gt;</code> permitting
polymorphism (<code>val_t</code> and <code>idx_t</code> are not
necessarily the same type) while also enforcing contiguous
vectorization.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">A</span>, <span class="st">"CSC_P"</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ :List of 8</span></span>
<span><span class="co">#&gt;   ..$ : int 0</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ index: num 2</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 3</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ index: num 4</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 3</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ index: num 13</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 1</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ index: num 14</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 1</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ index: num 24</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 3</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ index: num 25</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 2</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ index: num 26</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 1</span></span>
<span><span class="co">#&gt;  $ :List of 9</span></span>
<span><span class="co">#&gt;   ..$ : int 0</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ index: num 0</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 1</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ index: num 6</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 1</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ index: num 11</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 2</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ index: num 12</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 2</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ index: num 17</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 3</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ index: num 19</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 3</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ index: num 20</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 1</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ index: num 26</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="csc_np">CSC_NP<a class="anchor" aria-label="anchor" href="#csc_np"></a>
</h3>
<p>Stored as <code>std::vector&lt;idx_t&gt;</code> where values must be
of the same type as the index type, which is necessarily integral. This
can include signed or unsigned types.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">A</span>, <span class="st">"CSC_NP"</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ : int [1:14] 2 3 4 3 13 1 14 1 24 3 ...</span></span>
<span><span class="co">#&gt;  $ : int [1:16] 0 1 6 1 11 2 12 2 17 3 ...</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="tcsc_p">TCSC_P<a class="anchor" aria-label="anchor" href="#tcsc_p"></a>
</h3>
<p>Stored as
<code>std::vector&lt;std::pair&lt;val_t, std::vector&lt;idx_t&gt;&gt;&gt;</code>,
this is a structure that permits tabulated encoding and polymorphic
types. It is particularly inefficient in terms of memory storage and
iterator traversal, but possibly preferable when values are discrete but
non-integral, and extremely redundant.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">A</span>, <span class="st">"TCSC_P"</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ :List of 3</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 3</span></span>
<span><span class="co">#&gt;   .. ..$ index: num [1:3] 2 4 24</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 1</span></span>
<span><span class="co">#&gt;   .. ..$ index: num [1:3] 13 14 26</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 2</span></span>
<span><span class="co">#&gt;   .. ..$ index: num 25</span></span>
<span><span class="co">#&gt;  $ :List of 3</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 1</span></span>
<span><span class="co">#&gt;   .. ..$ index: num [1:3] 0 6 20</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 2</span></span>
<span><span class="co">#&gt;   .. ..$ index: num [1:3] 11 12 26</span></span>
<span><span class="co">#&gt;   ..$ :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ value: int 3</span></span>
<span><span class="co">#&gt;   .. ..$ index: num [1:2] 17 19</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="tcsc_np">TCSC_NP<a class="anchor" aria-label="anchor" href="#tcsc_np"></a>
</h3>
<p>Stored as <code>std::vector&lt;idx_t&gt;</code> where
<code>idx_t</code> must be signed and values must be positive and
integral. Values are denoted by a negative sign, indices by a positive
sign. Values are listed followed by all indices at which they occur.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">A</span>, <span class="st">"TCSC_NP"</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ : int [1:10] -3 2 4 24 -1 13 14 26 -2 25</span></span>
<span><span class="co">#&gt;  $ : int [1:11] -1 0 6 20 -2 11 12 26 -3 17 ...</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="trcsc_np">TRCSC_NP<a class="anchor" aria-label="anchor" href="#trcsc_np"></a>
</h3>
<p>Stored as <code>std::vector&lt;idx_t&gt;</code> where
<code>idx_t</code> may be signed (to permit signed values) or unsigned.
Values are listed, followed by the number of indices at which they
occur, followed by all indices with that value.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">A</span>, <span class="st">"TRCSC_NP"</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ : int [1:13] 3 3 2 4 24 1 3 13 14 26 ...</span></span>
<span><span class="co">#&gt;  $ : int [1:14] 1 3 0 6 20 2 3 11 12 26 ...</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="compute-considerations">Compute Considerations<a class="anchor" aria-label="anchor" href="#compute-considerations"></a>
</h2>
<p>Since all VSEs are column vectors, sparse matrix computations can
only be done column-wise in column-major format.</p>
<p>VSEs also rely on sparse random access iterators, which in the case
of <code>CSC_P</code>, <code>CSC_NP</code> is ordered by row index, but
in the cases of <code>T</code> formats is ordered firstly by value and
secondarily by row index. This means that sparse-sparse operations for
<code>T</code> formats are extremely inefficient, and thus
<code>T</code> formats should only use sparse-dense operations.</p>
</div>
<div class="section level2">
<h2 id="benchmarking">Benchmarking<a class="anchor" aria-label="anchor" href="#benchmarking"></a>
</h2>
<p>Since iterators are the workhorse of VSEs, two proof-of-concept
applications for iterators have been implemented. First, we compute the
sum of each VSE can be computed by traversing the container only with
interest in values, not indices. Second, we compute a sparse-dense
cross-product operation by traversing the container using a random
access iterator against a dense matrix. The former challenges efficient
traversal of the structure, the second challenges ordered vs. unordered
access to row indices.</p>
<p>Here we generate a matrix with 90% redundancy:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/rsparsematrix.html" class="external-link">rsparsematrix</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">100</span>, <span class="fl">0.1</span>, rand.x <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/calc_redundancy.html">calc_redundancy</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8992035</span></span></code></pre></div>
<p>And a matrix with 95% redundancy:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/rsparsematrix.html" class="external-link">rsparsematrix</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">100</span>, <span class="fl">0.1</span>, rand.x <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/calc_redundancy.html">calc_redundancy</a></span><span class="op">(</span><span class="va">A2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.9495477</span></span></code></pre></div>
<p>Now we can compute runtimes for this matrix using each compression
method:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span>, <span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/benchmark.html">benchmark</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">h</span><span class="op">)</span></span>
<span><span class="co">#&gt; constructing CSC</span></span>
<span><span class="co">#&gt; constructing CSC_P</span></span>
<span><span class="co">#&gt; constructing CSC_NP</span></span>
<span><span class="co">#&gt; constructing TCSC_P</span></span>
<span><span class="co">#&gt; constructing TCSC_NP</span></span>
<span><span class="co">#&gt; constructing RTCSC_NP</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bench_colsums</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-12-1.png" width="768"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bench_tcrossprod</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-12-2.png" width="768"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"colsums"</span><span class="op">)</span>, <span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"tcrossprod"</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-12-3.png" width="768"></p>
<p>And again for the matrix that is 95% redundant:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/benchmark.html">benchmark</a></span><span class="op">(</span><span class="va">A2</span>, <span class="va">h</span><span class="op">)</span></span>
<span><span class="co">#&gt; constructing CSC</span></span>
<span><span class="co">#&gt; constructing CSC_P</span></span>
<span><span class="co">#&gt; constructing CSC_NP</span></span>
<span><span class="co">#&gt; constructing TCSC_P</span></span>
<span><span class="co">#&gt; constructing TCSC_NP</span></span>
<span><span class="co">#&gt; constructing RTCSC_NP</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bench_colsums</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-13-1.png" width="768"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bench_tcrossprod</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-13-2.png" width="768"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"colsums"</span><span class="op">)</span>, <span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"tcrossprod"</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-13-3.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="size-of-objects">Size of objects<a class="anchor" aria-label="anchor" href="#size-of-objects"></a>
</h2>
<p>Calculate the compression of each object using
<code>memuse</code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">encodings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CSC"</span>, <span class="st">"CSC_P"</span>, <span class="st">"CSC_NP"</span>, <span class="st">"TCSC_P"</span>, <span class="st">"TCSC_NP"</span>, <span class="st">"TRCSC_NP"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">sparsity</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.2</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/rsparsematrix.html" class="external-link">rsparsematrix</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">100</span>, <span class="va">sparsity</span>, rand.x <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">i</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">redundancy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_redundancy.html">calc_redundancy</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span>    <span class="va">df</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      <span class="st">"encoding"</span> <span class="op">=</span> <span class="va">encodings</span>, </span>
<span>      <span class="st">"size"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">encodings</span>, <span class="kw">function</span><span class="op">(</span><span class="va">encoding</span><span class="op">)</span> <span class="fu"><a href="../reference/memuse.html">memuse</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">encoding</span><span class="op">)</span><span class="op">)</span>, </span>
<span>      <span class="st">"redundancy"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">redundancy</span><span class="op">)</span>, </span>
<span>      <span class="st">"sparsity"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">A</span><span class="op">@</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;          encoding  size redundancy sparsity</span></span>
<span><span class="co">#&gt; CSC           CSC  8800   0.657156     0.01</span></span>
<span><span class="co">#&gt; CSC_P       CSC_P  8000   0.657156     0.01</span></span>
<span><span class="co">#&gt; CSC_NP     CSC_NP  6400   0.657156     0.01</span></span>
<span><span class="co">#&gt; TCSC_P     TCSC_P 15652   0.657156     0.01</span></span>
<span><span class="co">#&gt; TCSC_NP   TCSC_NP  4788   0.657156     0.01</span></span>
<span><span class="co">#&gt; TRCSC_NP TRCSC_NP  5176   0.657156     0.01</span></span></code></pre></div>
<p>Now plot the results to learn what are the most efficient data
structures as a function of sparsity and redundancy:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">sparsity</span> <span class="op">==</span> <span class="fl">0.05</span><span class="op">)</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">redundancy</span>, <span class="va">size</span>, color <span class="op">=</span> <span class="va">encoding</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>trans <span class="op">=</span> <span class="st">"log10"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"sparsity = 0.05"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-15-1.png" width="384"></p>
<p>As a function of sparsity (holding redundancy as constant as
possible):</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">redundancy</span> <span class="op">&gt;=</span> <span class="fl">0.85</span> <span class="op">&amp;</span> <span class="va">redundancy</span> <span class="op">&lt;=</span> <span class="fl">0.88</span><span class="op">)</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">sparsity</span>, <span class="va">size</span>, color <span class="op">=</span> <span class="va">encoding</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0</span>, widht <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>trans <span class="op">=</span> <span class="st">"log10"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"redundancy in the range (0.85, 0.88)"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Ignoring unknown parameters: widht</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-16-1.png" width="384"></p>
<p>Compare to memory usage of R <code>dgCMatrix</code>, assuming that
indices and values in dgCMatrix can be held with
<code>short int</code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/rsparsematrix.html" class="external-link">rsparsematrix</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">100</span>, <span class="fl">0.05</span>, rand.x <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">redundancy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/calc_redundancy.html">calc_redundancy</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"encoding"</span> <span class="op">=</span> <span class="va">encodings</span>, <span class="st">"bytes"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">encodings</span>, <span class="kw">function</span><span class="op">(</span><span class="va">encoding</span><span class="op">)</span> <span class="fu"><a href="../reference/memuse.html">memuse</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">encoding</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"encoding"</span> <span class="op">=</span> <span class="st">"dgCMatrix"</span>, <span class="st">"bytes"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">encoding</span>, <span class="op">-</span><span class="va">bytes</span><span class="op">)</span>, <span class="va">bytes</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="st">"object size (bytes)"</span>, </span>
<span>    x <span class="op">=</span> <span class="st">"encoding"</span>, </span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"95% sparsity, "</span>, <span class="va">redundancy</span>, <span class="st">"% redundancy"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-17-1.png" width="384"></p>
</div>
<div class="section level2">
<h2 id="future-work">Future work<a class="anchor" aria-label="anchor" href="#future-work"></a>
</h2>
<p>Test systematically on a collection of diverse integral-valued sparse
matrices, including single-cell datasets, movielens datasets, etc.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Zach DeBruine.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
